<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Scopes</title>
<link rel="stylesheet" href=".././doc/src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.0">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;Boost.DI (Dependency Injection) 1.0">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;Boost.DI (Dependency Injection) 1.0">
<link rel="prev" href="concepts.html" title="Concepts">
<link rel="next" href="policies.html" title="Policies">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src=".././boost.png"></td>
<td align="center"><a href=".././index.html">Home</a></td>
<td align="center"><a href=".././libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href=".././more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="concepts.html"><img src=".././doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src=".././doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src=".././doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="policies.html"><img src=".././doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost_di__dependency_injection_.scopes"></a><a class="link" href="scopes.html" title="Scopes">Scopes</a>
</h2></div></div></div>
<div class="toc"><dl class="toc">
<dt><span class="section"><a href="scopes.html#boost_di__dependency_injection_.scopes.deduce__default_">Deduce
      (Default)</a></span></dt>
<dt><span class="section"><a href="scopes.html#boost_di__dependency_injection_.scopes.external">External</a></span></dt>
<dt><span class="section"><a href="scopes.html#boost_di__dependency_injection_.scopes.unique">Unique</a></span></dt>
<dt><span class="section"><a href="scopes.html#boost_di__dependency_injection_.scopes.shared">Shared</a></span></dt>
<dt><span class="section"><a href="scopes.html#boost_di__dependency_injection_.scopes.session">Session</a></span></dt>
</dl></div>
<p>
      Boost.DI scopes create and maintain dependencies life time. If no scope will
      be given whilst binding deduce scope will be assumed.
    </p>
<p>
      Synopsis
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">scope_</span> <span class="special">{</span>
    <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">int_</span><span class="special">&lt;</span><span class="identifier">N</span><span class="special">&gt;</span> <span class="identifier">priority</span><span class="special">;</span> <span class="comment">// N - priority, 1=lowest, N=highest</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">TExpected</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">TGiven</span> <span class="special">=</span> <span class="identifier">TExpected</span><span class="special">&gt;</span>
    <span class="keyword">class</span> <span class="identifier">scope</span> <span class="special">{</span>
    <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">...</span> <span class="identifier">T</span><span class="special">&gt;</span>
        <span class="identifier">result_type</span> <span class="identifier">create</span><span class="special">(</span><span class="identifier">T</span><span class="special">&amp;&amp;...</span> <span class="identifier">args</span><span class="special">);</span>

        <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">TAction</span><span class="special">&gt;</span>
        <span class="keyword">void</span> <span class="identifier">call</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">TAction</span><span class="special">&amp;);</span>
    <span class="special">};</span>
<span class="special">};</span>
</pre>
<p>
    </p>
<p>
      Scopes use <code class="computeroutput"><span class="identifier">wrappers</span></code> to return
      convertible objects. <code class="computeroutput"><span class="identifier">Wrappers</span></code>
      are able to convert to requested types accurately to their definition. There
      are 5 basic types of wrappers.
    </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                Wrapper
              </p>
            </th>
<th>
              <p>
                Description
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                copy
              </p>
            </td>
<td>
              <p>
                conversion to lvalue/pointer/smart_ptr
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                reference
              </p>
            </td>
<td>
              <p>
                conversion to reference
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                shared
              </p>
            </td>
<td>
              <p>
                conversion to smart_ptr
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                universal
              </p>
            </td>
<td>
              <p>
                conversion to any type wrappers provide and to const ref/named on
                top of it
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                value
              </p>
            </td>
<td>
              <p>
                conversion to lvalue/rvalue/pointer/smart_pointer
              </p>
            </td>
</tr>
</tbody>
</table></div>
<div class="informaltable"><table class="table">
<colgroup><col></colgroup>
<tbody><tr><td>
              <p>
                Tests: <a href="../test/ut/wrappers/universal_ut.cpp" target="_top">test/ut/wrappers/universal_ut.cpp</a>
              </p>
            </td></tr></tbody>
</table></div>
<p>
      Implementation of custom scope requires
    </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
          Implementation of the scope
        </li>
<li class="listitem">
          [optional] mapping to DSL binding to easier usage (custom_scope&lt;...&gt;)
        </li>
</ul></div>
<p>
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">custom_scope</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">mpl</span><span class="special">::</span><span class="identifier">int_</span><span class="special">&lt;</span><span class="number">0</span><span class="special">&gt;</span> <span class="identifier">priority</span><span class="special">;</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">TExpected</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">TGiven</span><span class="special">&gt;</span>
    <span class="keyword">class</span> <span class="identifier">scope</span> <span class="special">{</span>
    <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">typedef</span> <span class="identifier">scope</span> <span class="identifier">type</span><span class="special">;</span>
        <span class="keyword">typedef</span> <span class="identifier">di</span><span class="special">::</span><span class="identifier">wrappers</span><span class="special">::</span><span class="identifier">shared</span> <span class="identifier">result_type</span><span class="special">;</span>

        <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">...</span> <span class="identifier">Args</span><span class="special">&gt;</span>
        <span class="identifier">result_type</span> <span class="identifier">create</span><span class="special">(</span><span class="identifier">Args</span><span class="special">&amp;&amp;...</span> <span class="identifier">args</span><span class="special">)</span> <span class="special">{</span>
            <span class="keyword">return</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">make_shared</span><span class="special">&lt;</span><span class="identifier">TGiven</span><span class="special">&gt;(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">forward</span><span class="special">(</span><span class="identifier">args</span><span class="special">)...);</span>
        <span class="special">}</span>
    <span class="special">};</span>
<span class="special">};</span>

<span class="keyword">namespace</span> <span class="identifier">di</span> <span class="special">{</span>

<span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">...</span> <span class="identifier">T</span><span class="special">&gt;</span>
<span class="keyword">struct</span> <span class="identifier">custom_scope</span>
    <span class="special">:</span> <span class="identifier">scope</span><span class="special">&lt;</span> <span class="special">::</span><span class="identifier">custom_scope</span> <span class="special">&gt;::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">...&gt;</span>
<span class="special">{</span> <span class="special">};</span>

<span class="special">}</span> <span class="comment">// namespace di</span>
</pre>
<p>
    </p>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_di__dependency_injection_.scopes.deduce__default_"></a><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.deduce__default_" title="Deduce (Default)">Deduce
      (Default)</a>
</h3></div></div></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.deduce__default_.h0"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.deduce__default_.synopsis"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.deduce__default_.synopsis">Synopsis</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">deduce</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="keyword">typename</span> <span class="special">=</span> <span class="identifier">T</span><span class="special">&gt;</span>
    <span class="keyword">class</span> <span class="identifier">scope</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.deduce__default_.h1"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.deduce__default_.description"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.deduce__default_.description">Description</a>
      </h6>
<p>
        Default scope which will be converted to one of the scopes shared/unique/external
        accordingly to <code class="computeroutput"><span class="identifier">Scope</span> <span class="identifier">Traits</span></code>.
      </p>
<div class="table">
<a name="boost_di__dependency_injection_.scopes.deduce__default_.scope_traits"></a><p class="title"><b>Table&#160;1.1.&#160;Scope Traits</b></p>
<div class="table-contents"><table class="table" summary="Scope Traits">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Type
                </p>
              </th>
<th>
                <p>
                  Scope
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  T&amp;
                </p>
              </td>
<td>
                <p>
                  external
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  T
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  const T&amp;
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  T*
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  const T*
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  unique_ptr&lt;T&gt;
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  const unique_ptr&lt;T&gt;&amp;
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  T&amp;&amp;
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  const T&amp;&amp;
                </p>
              </td>
<td>
                <p>
                  unique
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  shared_ptr&lt;T&gt;
                </p>
              </td>
<td>
                <p>
                  shared
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  const shared_ptr&lt;T&gt;&amp;
                </p>
              </td>
<td>
                <p>
                  shared
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  weak_ptr&lt;T&gt;
                </p>
              </td>
<td>
                <p>
                  shared
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  const weak_ptr&lt;T&gt;&amp;
                </p>
              </td>
<td>
                <p>
                  shared
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  named&lt;T, TName&gt;
                </p>
              </td>
<td>
                <p>
                  scope of T
                </p>
              </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><h6>
<a name="boost_di__dependency_injection_.scopes.deduce__default_.h2"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.deduce__default_.example"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.deduce__default_.example">Example</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="identifier">di</span><span class="special">::</span><span class="identifier">deduce</span><span class="special">&lt;</span><span class="identifier">implementation</span><span class="special">&gt;()</span>
<span class="identifier">di</span><span class="special">::</span><span class="identifier">deduce</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">,</span> <span class="identifier">implementation</span><span class="special">&gt;&gt;()</span>
<span class="identifier">di</span><span class="special">::</span><span class="identifier">deduce</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind_int</span><span class="special">&lt;</span><span class="number">42</span><span class="special">&gt;&gt;()</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.deduce__default_.h3"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.deduce__default_.conversions"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.deduce__default_.conversions">Conversions</a>
      </h6>
<p>
        Refer to <code class="computeroutput"><span class="identifier">Scopes</span> <span class="identifier">Conversions</span></code>
        table.
      </p>
<div class="informaltable"><table class="table">
<colgroup><col></colgroup>
<tbody><tr><td>
                <p>
                  Tests: <a href="../test/ut/scopes/deduce_ut.cpp" target="_top">test/ut/scopes/deduce_ut.cpp</a>
                </p>
              </td></tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_di__dependency_injection_.scopes.external"></a><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.external" title="External">External</a>
</h3></div></div></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.external.h0"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.external.synopsis"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.external.synopsis">Synopsis</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">&gt;</span> <span class="keyword">class</span> <span class="identifier">TWrapper</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">external</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">int_</span><span class="special">&lt;</span><span class="number">1</span><span class="special">&gt;</span> <span class="identifier">priority</span><span class="special">;</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">TExpected</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">TGiven</span> <span class="special">=</span> <span class="identifier">TExpected</span><span class="special">&gt;</span>
    <span class="keyword">class</span> <span class="identifier">scope</span> <span class="special">{</span>
    <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">...</span> <span class="identifier">TArgs</span><span class="special">&gt;</span>
        <span class="identifier">TWrapper</span><span class="special">&lt;</span><span class="identifier">TExpected</span><span class="special">,</span> <span class="identifier">TGiven</span><span class="special">&gt;</span> <span class="identifier">create</span><span class="special">(</span><span class="identifier">TArgs</span><span class="special">&amp;&amp;...);</span>
    <span class="special">};</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.external.h1"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.external.description"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.external.description">Description</a>
      </h6>
<p>
        Scope representing external value (passed by user). The life time of the
        object depends on the user. Boost.DI is not responsible of managing of the
        passed object, however values and strings will be copied and managed by the
        library. External scope has priority before other scopes which means that
        if some value/type will be binded using different scope as well then this
        binding won't be taken into account.
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.external.h2"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.external.example"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.external.example">Example</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;::</span><span class="identifier">to</span><span class="special">(</span><span class="number">42</span><span class="special">)</span>
<span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">&gt;::</span><span class="identifier">to</span><span class="special">(</span><span class="string">"text"</span><span class="special">)</span>
<span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">example</span><span class="special">&gt;::</span><span class="identifier">to</span><span class="special">(</span><span class="identifier">make_shared</span><span class="special">&lt;</span><span class="identifier">example</span><span class="special">&gt;())</span>
<span class="identifier">example</span> <span class="identifier">example_</span><span class="special">;</span>
<span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">example</span><span class="special">&gt;::</span><span class="identifier">to</span><span class="special">(</span><span class="identifier">cref</span><span class="special">(</span><span class="identifier">example_</span><span class="special">))</span>
<span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">example</span><span class="special">&gt;::</span><span class="identifier">to</span><span class="special">(</span><span class="identifier">ref</span><span class="special">(</span><span class="identifier">example_</span><span class="special">))</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.external.h3"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.external.conversions"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.external.conversions">Conversions</a>
      </h6>
<p>
        Refer to <code class="computeroutput"><span class="identifier">Scopes</span> <span class="identifier">Conversions</span></code>
        table.
      </p>
<div class="informaltable"><table class="table">
<colgroup><col></colgroup>
<tbody><tr><td>
                <p>
                  Tests: <a href="../test/ut/scopes/external_ut.cpp" target="_top">test/ut/scopes/external_ut.cpp</a>
                  | <a href="../test/ut/wrappers/value_ut.cpp" target="_top">test/ut/wrappers/value_ut.cpp</a>
                  | <a href="../test/ut/wrappers/reference_ut.cpp" target="_top">test/ut/wrappers/reference_ut.cpp</a>
                  | <a href="../test/ut/wrappers/shared_ut.cpp" target="_top">test/ut/wrappers/shared_ut.cpp</a>
                </p>
              </td></tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_di__dependency_injection_.scopes.unique"></a><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.unique" title="Unique">Unique</a>
</h3></div></div></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.unique.h0"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.unique.synopsis"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.unique.synopsis">Synopsis</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">&gt;</span> <span class="keyword">class</span> <span class="identifier">TWrapper</span> <span class="special">=</span> <span class="identifier">wrappers</span><span class="special">::</span><span class="identifier">copy</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">unique</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">int_</span><span class="special">&lt;</span><span class="number">0</span><span class="special">&gt;</span> <span class="identifier">priority</span><span class="special">;</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">TExpected</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">TGiven</span> <span class="special">=</span> <span class="identifier">TExpected</span><span class="special">&gt;</span>
    <span class="keyword">class</span> <span class="identifier">scope</span> <span class="special">{</span>
    <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">...</span> <span class="identifier">TArgs</span><span class="special">&gt;</span>
        <span class="identifier">TWrapper</span><span class="special">&lt;</span><span class="identifier">TExpected</span><span class="special">,</span> <span class="identifier">TGiven</span><span class="special">&gt;</span> <span class="identifier">create</span><span class="special">(</span><span class="identifier">TArgs</span><span class="special">&amp;&amp;...);</span>
    <span class="special">};</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.unique.h1"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.unique.description"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.unique.description">Description</a>
      </h6>
<p>
        Scope representing unique value, meaning unique value always will be passed
        to the constructor.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src=".././doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          In case of pointers user will be responsible to take care of deleting them
        </p></td></tr>
</table></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.unique.h2"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.unique.example"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.unique.example">Example</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="identifier">unique</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind_int</span><span class="special">&lt;</span><span class="number">42</span><span class="special">&gt;&gt;()</span>
<span class="identifier">unique</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">,</span> <span class="identifier">implementation</span><span class="special">&gt;&gt;()</span>
</pre>
<p>
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src=".././doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          Scope deduction has lower priority than explicit scope definition, so shared_ptr
          parameter might be forced to be unique
        </p></td></tr>
</table></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.unique.h3"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.unique.conversions"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.unique.conversions">Conversions</a>
      </h6>
<p>
        Refer to <code class="computeroutput"><span class="identifier">Scopes</span> <span class="identifier">Conversions</span></code>
        table.
      </p>
<div class="informaltable"><table class="table">
<colgroup><col></colgroup>
<tbody><tr><td>
                <p>
                  Tests: <a href="../test/ut/scopes/unique_ut.cpp" target="_top">test/ut/scopes/unique_ut.cpp</a>
                  | <a href="../test/ut/wrappers/copy_ut.cpp" target="_top">test/ut/wrappers/copy_ut.cpp</a>
                </p>
              </td></tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_di__dependency_injection_.scopes.shared"></a><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.shared" title="Shared">Shared</a>
</h3></div></div></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.shared.h0"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.shared.synopsis"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.shared.synopsis">Synopsis</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">&gt;</span> <span class="keyword">class</span> <span class="identifier">TWrapper</span> <span class="special">=</span> <span class="identifier">wrappers</span><span class="special">::</span><span class="identifier">shared</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">shared</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">int_</span><span class="special">&lt;</span><span class="number">0</span><span class="special">&gt;</span> <span class="identifier">priority</span><span class="special">;</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">TExpected</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">TGiven</span> <span class="special">=</span> <span class="identifier">TExpected</span><span class="special">&gt;</span>
    <span class="keyword">class</span> <span class="identifier">scope</span> <span class="special">{</span>
    <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">...</span> <span class="identifier">TArgs</span><span class="special">&gt;</span>
        <span class="identifier">TWrapper</span><span class="special">&lt;</span><span class="identifier">TExpected</span><span class="special">,</span> <span class="identifier">TGiven</span><span class="special">&gt;</span> <span class="identifier">create</span><span class="special">(</span><span class="identifier">TArgs</span><span class="special">&amp;&amp;...);</span>
    <span class="special">};</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.shared.h1"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.shared.description"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.shared.description">Description</a>
      </h6>
<p>
        Scope representing shared/session value, meaning passed value will be shared
        between all given instances. Boost.DI to achieve that is using smart shared
        pointers. This scope will be deduced in case of shared ptr.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src=".././doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          Shared scope will convert between std::shared_ptr and boost::shared_ptr
          if required. Primary smart pointer might be set by <code class="computeroutput"><span class="identifier">BOOST_DI_CFG_STD_SMART_PTR</span></code>
          and <code class="computeroutput"><span class="identifier">BOOST_DI_CFG_BOOST_SMART_PTR</span></code>.
          Only primary smart pointer will be able to be converted to weak_ptr.
        </p></td></tr>
</table></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.shared.h2"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.shared.example"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.shared.example">Example</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="identifier">shared</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind_int</span><span class="special">&lt;</span><span class="number">42</span><span class="special">&gt;&gt;()</span>
<span class="identifier">shared</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">,</span> <span class="identifier">implementation</span><span class="special">&gt;&gt;()</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.shared.h3"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.shared.conversions"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.shared.conversions">Conversions</a>
      </h6>
<p>
        Refer to <code class="computeroutput"><span class="identifier">Scopes</span> <span class="identifier">Conversions</span></code>
        table.
      </p>
<div class="informaltable"><table class="table">
<colgroup><col></colgroup>
<tbody><tr><td>
                <p>
                  Tests: <a href="../test/ut/scopes/shared_ut.cpp" target="_top">test/ut/scopes/shared_ut.cpp</a>
                  | <a href="../test/ut/wrappers/shared_ut.cpp" target="_top">test/ut/wrappers/shared_ut.cpp</a>
                </p>
              </td></tr></tbody>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_di__dependency_injection_.scopes.session"></a><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.session" title="Session">Session</a>
</h3></div></div></div>
<h6>
<a name="boost_di__dependency_injection_.scopes.session.h0"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.session.synopsis"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.session.synopsis">Synopsis</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">&gt;</span> <span class="keyword">class</span> <span class="identifier">TWrapper</span> <span class="special">=</span> <span class="identifier">wrappers</span><span class="special">::</span><span class="identifier">shared</span><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">session</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
    <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">int_</span><span class="special">&lt;</span><span class="number">0</span><span class="special">&gt;</span> <span class="identifier">priority</span><span class="special">;</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">TExpected</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">TGiven</span> <span class="special">=</span> <span class="identifier">TExpected</span><span class="special">&gt;</span>
    <span class="keyword">class</span> <span class="identifier">scope</span> <span class="special">{</span>
    <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span><span class="special">...</span> <span class="identifier">TArgs</span><span class="special">&gt;</span>
        <span class="identifier">TWrapper</span><span class="special">&lt;</span><span class="identifier">TExpected</span><span class="special">,</span> <span class="identifier">TGiven</span><span class="special">&gt;</span> <span class="identifier">create</span><span class="special">(</span><span class="identifier">TArgs</span><span class="special">&amp;&amp;...);</span>

        <span class="keyword">void</span> <span class="identifier">call</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">session_entry</span><span class="special">&amp;);</span>
        <span class="keyword">void</span> <span class="identifier">call</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">session_exit</span><span class="special">&amp;);</span>
    <span class="special">};</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.session.h1"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.session.description"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.session.description">Description</a>
      </h6>
<p>
        Scope representing shared value, meaning passed value will be shared between
        all given instances and will be empty if it won't be in scope. Scope is activated
        by call of <code class="computeroutput"><span class="identifier">call</span></code> method with
        <code class="computeroutput"><span class="identifier">session_entry</span></code> parameter and
        deactivated by call of <code class="computeroutput"><span class="identifier">call</span></code>
        method with <code class="computeroutput"><span class="identifier">session_exit</span></code>
        parameter;
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.session.h2"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.session.example"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.session.example">Example</a>
      </h6>
<p>
</p>
<pre class="programlisting"><span class="identifier">session</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind_int</span><span class="special">&lt;</span><span class="number">42</span><span class="special">&gt;&gt;()</span>
<span class="identifier">session</span><span class="special">&lt;</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">,</span> <span class="identifier">implementation</span><span class="special">&gt;&gt;()</span>
</pre>
<p>
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">auto</span> <span class="identifier">injector</span> <span class="special">=</span> <span class="identifier">di</span><span class="special">::</span><span class="identifier">make_injector</span><span class="special">(</span>
    <span class="identifier">shared</span><span class="special">&lt;</span><span class="identifier">bind</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">,</span> <span class="identifier">implementation</span><span class="special">&gt;&gt;()</span>
<span class="special">);</span>

<span class="identifier">assert</span><span class="special">(!</span><span class="identifier">injector</span><span class="special">.</span><span class="identifier">create</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">unique_ptr</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">&gt;&gt;())</span>

<span class="identifier">injector</span><span class="special">.</span><span class="identifier">call</span><span class="special">(</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">scopes</span><span class="special">::</span><span class="identifier">session_entry</span><span class="special">());</span>
<span class="identifier">assert</span><span class="special">(</span><span class="identifier">injector</span><span class="special">.</span><span class="identifier">create</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">unique_ptr</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">&gt;&gt;())</span>

<span class="identifier">injector</span><span class="special">.</span><span class="identifier">call</span><span class="special">(</span><span class="identifier">di</span><span class="special">::</span><span class="identifier">scopes</span><span class="special">::</span><span class="identifier">session_exit</span><span class="special">());</span>
<span class="identifier">assert</span><span class="special">(!</span><span class="identifier">injector</span><span class="special">.</span><span class="identifier">create</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">unique_ptr</span><span class="special">&lt;</span><span class="identifier">interface</span><span class="special">&gt;&gt;())</span>
</pre>
<p>
      </p>
<h6>
<a name="boost_di__dependency_injection_.scopes.session.h3"></a>
        <span class="phrase"><a name="boost_di__dependency_injection_.scopes.session.conversions"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.session.conversions">Conversions</a>
      </h6>
<p>
        Refer to <code class="computeroutput"><span class="identifier">Scopes</span> <span class="identifier">Conversions</span></code>
        table.
      </p>
<div class="informaltable"><table class="table">
<colgroup><col></colgroup>
<tbody><tr><td>
                <p>
                  Tests: <a href="../test/ut/scopes/session_ut.cpp" target="_top">test/ut/scopes/session_ut.cpp</a>
                  | <a href="../test/ut/wrappers/shared_ut.cpp" target="_top">test/ut/wrappers/shared_ut.cpp</a>
                </p>
              </td></tr></tbody>
</table></div>
</div>
<h3>
<a name="boost_di__dependency_injection_.scopes.h0"></a>
      <span class="phrase"><a name="boost_di__dependency_injection_.scopes.scopes_conversions"></a></span><a class="link" href="scopes.html#boost_di__dependency_injection_.scopes.scopes_conversions">Scopes
      Conversions</a>
    </h3>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src=".././doc/src/images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top"><p>
        In current version of Boost.DI rvalue references aren't available for <code class="computeroutput"><span class="identifier">Microsoft</span> <span class="identifier">Visual</span>
        <span class="identifier">Studio</span> <span class="identifier">Compiler</span></code>
      </p></td></tr>
</table></div>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                Type
              </p>
            </th>
<th>
              <p>
                external
              </p>
            </th>
<th>
              <p>
                session
              </p>
            </th>
<th>
              <p>
                shared
              </p>
            </th>
<th>
              <p>
                unique
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                T
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                T*
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                T&amp;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                const T&amp;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                T&amp;&amp;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                const T*
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                std::shared_ptr&lt;T&gt;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                boost::shared_ptr&lt;T&gt;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                std::unique_ptr&lt;T&gt;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                std::auto_ptr&lt;T&gt;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
            </td>
<td>
            </td>
<td>
            </td>
<td>
            </td>
<td>
            </td>
</tr>
<tr>
<td>
              <p>
                const T&amp;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                named&lt;T, name&gt;
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
<td>
              <p>
                X
              </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2014 Krzysztof Jusiak<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="concepts.html"><img src=".././doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src=".././doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src=".././doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="policies.html"><img src=".././doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
