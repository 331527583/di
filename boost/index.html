<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">

<meta name="author" content="Krzysztof Jusiak">
<link rel="canonical" href="http://boost-experimental.github.io/di/index.html">
<title>Boost.DI</title>

<link href="./css/boostbook.css" rel="stylesheet">
<link href="./css/github.css" rel="stylesheet">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">

<div width="100%">
<a href="http://www.boost.org/"><img alt="Boost C++ Libraries" width="277" height="86" src="./images/boost.png"></a>
</div>

<hr>
<div class="spirit-nav">
<a accesskey="p"  ><img src="./images/prev.png" alt="Prev"></a><a accesskey="u" href="index.html"><img src="./images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="./images/home.png" alt="Home"></a><a accesskey="n"  href="overview/index.html"><img src="./images/next.png" alt="Next"></a>
</div>

<div class="chapter">


<div class="chapter">
<div class="titlepage"><div>
<div><h2 class="title">
<a></a>Boost.DI</h2></div>
<div><div class="author"><h3 class="author">
Krzysztof Jusiak
</h3></div></div>
<div><p class="copyright">Copyright &copy; 2016</p></div>
<div><div class="legalnotice">
<a name="idm45555445986288"></a><p>Distributed under the Boost Software License, Version 1.0.
      (See accompanying file <code class="filename">LICENSE_1_0.txt</code> or copy at
      <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></div>
</div></div>

<div class="toc">
<p><b>Table of Contents</b></p>
<dl class="toc">

    
        <dt><span class="section"><a href="index.html">Introduction</a></span></dt>
    

    
        <dt><span class="section"><a href="overview/index.html">Overview</a></span></dt>
    

    
        <dt><span class="section"><a href="benchmarks/index.html">Benchmarks</a></span></dt>
    

    
        <dt><span class="section"><a href="tutorial/index.html">Tutorial</a></span></dt>
    

    
        <dt><span class="section"><a href="try_it/index.html">Try It!</a></span></dt>
    

    
        <dt><span class="section"><a href="user_guide/index.html">User Guide</a></span></dt>
    

    
        <dt><span class="section"><a href="examples/index.html">Examples</a></span></dt>
    

    
        <dt><span class="section"><a href="extensions/index.html">Extensions</a></span></dt>
    

    
        <dt><span class="section"><a href="FAQ/index.html">FAQ</a></span></dt>
    

    
        <dt><span class="section"><a href="CHANGELOG/index.html">CHANGELOG</a></span></dt>
    

    
        <dt><span class="section"><a href="TODO/index.html">TODO</a></span></dt>
    

</dl>
</div>



<div class="section">
<p><a href="http://www.boost.org/LICENSE_1_0.txt" target="_blank"><img alt="Boost Licence" src="http://img.shields.io/badge/license-boost-blue.svg" /></a>
<a href="https://github.com/boost-experimental/di/releases" target="_blank"><img alt="Version" src="https://badge.fury.io/gh/boost-experimental%2Fdi.svg" /></a>
<a href="https://travis-ci.org/boost-experimental/di" target="_blank"><img alt="Build Status" src="https://img.shields.io/travis/boost-experimental/di/cpp14.svg?label=linux/osx" /></a>
<a href="https://ci.appveyor.com/project/krzysztof-jusiak/di" target="_blank"><img alt="Build Status" src="https://img.shields.io/appveyor/ci/krzysztof-jusiak/di/cpp14.svg?label=windows" /></a>
<a href="https://coveralls.io/r/boost-experimental/di?branch=cpp14" target="_blank"><img alt="Coveralls" src="http://img.shields.io/coveralls/boost-experimental/di/cpp14.svg" /></a>
<a href="http://github.com/boost-experimental/di/issues" target="_blank"><img alt="Github Issues" src="https://img.shields.io/github/issues/boost-experimental/di.svg" /></a></p>
<hr />
<h1 id="introduction">Introduction</h1>
<table>
<thead>
<tr>
<th><strong>Experimental Boost.DI</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Your C++14 header only Dependency Injection library with no dependencies (<a href="http://boost-experimental.github.io/di/try_it/index.html"><strong>Try it online!</strong></a>)</td>
<td><a class="github-button" href="https://github.com/boost-experimental/di" data-style="mega" data-count-href="/boost-experimental/di/stargazers" data-count-api="/repos/boost-experimental/di#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star boost-experimental/di on GitHub">GitHub</a></td>
</tr>
</tbody>
</table>
<div class="important">
<h3 class="wy-text-neutral"><span class="fa fa-info-circle wy-text-info"></span>&nbsp; Latest Release: <b>v1.0.0</b> (February 22, 2016)</h3>
<a href="../releases" class="btn btn-success" style="margin-bottom:8px;" role="button"><span class="fa fa-download"></span>&nbsp; <b>Download</b></a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="CHANGELOG/index.html" class="btn btn-info" style="margin-bottom:8px;" role="button"><span class="fa fa-reorder"></span>&nbsp; <b>Changelog</b></a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="tutorial/index.html" class="btn btn-warning" style="margin-bottom:8px;" role="button"><span class="fa fa-gear"></span>&nbsp; <b>Tutorial</b></a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="examples/index.html" class="btn btn-danger" style="margin-bottom:8px;" role="button"><span class="fa fa-book"></span>&nbsp; <b>Examples</b></a>
</div>

<h1 id="what-is-dependency-injection">What is Dependency Injection?</h1>
<blockquote>
<p>"Don't call us, we'll call you", Hollywood principle</p>
</blockquote>
<p><strong><a href="http://www.youtube.com/watch?v=IKD2-MAkXyQ">Dependency Injection</a> (DI)</strong> involves passing (injecting) one or more dependencies (or services) to a dependent object (or client) which become part of the clientâ€™s state.
It is like the Strategy Pattern, except the strategy is set once, at construction. DI enables loosely coupled designs, which are easier to maintain and test.</p>
<blockquote>
<p><strong>"Let's make some coffee!"</strong></p>
</blockquote>
<p><center><a href="./images/coffee_maker.png"><img alt="Coffee Maker" src="./images/coffee_maker.png" /></a></center></p>
<pre><code class="cpp">                      No Dependency injection                 | Dependency Injection
                      ----------------------------------------|-------------------------------------------
                      class coffee_maker {                    | class coffee_maker {
                      public:                                 | public:
                          void brew() {                       |   coffee_maker(shared_ptr&lt;iheater&gt; heater
                              heater-&gt;on();                   |              , unique_ptr&lt;ipump&gt; pump)
                              pump-&gt;pump();                   |         : heater(heater), pump(move(pump))
                              clog &lt;&lt; &quot;coffee&quot;! &lt;&lt; endl;      |     { }
                              heater-&gt;off();                  |
                          }                                   |     void brew() {
                                                              |         heater-&gt;on();
                      private:                                |         pump-&gt;pump();
                          shared_ptr&lt;iheater&gt; heater =        |         clog &lt;&lt; &quot;coffee!&quot; &lt;&lt; endl;
                              make_shared&lt;electric_heater&gt;(); |         heater-&gt;off();
                                                              |     }
                          unique_ptr&lt;ipump&gt; pump =            |
                              make_unique&lt;heat_pump&gt;(heater); | private:
                      };                                      |     shared_ptr&lt;iheater&gt; heater;
                                                              |     unique_ptr&lt;ipump&gt; pump;
                                                              | };
</code></pre>

<h3 id="do-i-need-dependency-injection">Do I need Dependency Injection?</h3>
<ul>
<li>DI provides loosely coupled code (separation of business logic and object creation)</li>
<li>DI provides easier to maintain code (different objects might be easily injected)</li>
<li>
<p>DI provides easier to test code (fakes objects might be injected)</p>
<ul>
<li><a href="http://www.youtube.com/watch?v=RlfLCWKxHJ0">The Clean Code Talks - Don't Look For Things!</a></li>
<li><a href="http://www.youtube.com/watch?v=oK_XtfXPkqw">A New Type of dependency injection</a></li>
</ul>
</li>
</ul>
<h3 id="do-i-need-a-di-frameworklibrary">Do I need a DI Framework/Library?</h3>
<p>Depending on a project and its scale you may put up with or without a DI library, however, in any project
a DI framework may <strong>free you</strong> from maintaining a following (boilerplate) code...</p>
<pre><code class="cpp">logger logger_;
renderer renderer_;
view view_{renderer_, logger_};
model model_{logger_};
controller controller_{model_, view_, logger_};
user user_{loger_};
app app_{controller_, user_};
</code></pre>

<p>Notice that <strong>ORDER</strong> in which above dependencies are created is <strong>IMPORTANT</strong> as well as that
<strong>ANY</strong> change in <strong>ANY</strong> of the objects constructor will <strong>REQUIRE</strong> a change in this code!</p>
<p>DI library, not only let you forget about maintaining above code (See <a href="tutorial/index.html#1-basic-create-objects-tree">Create Objects Tree</a>),
but also can help you with...</p>
<ul>
<li>Test it (See <a href="extensions/index.html#mocks-provider">Mocks Provider</a>)</li>
<li>Serialize it (See <a href="extensions/index.html#serialize">Serialize</a>)</li>
<li>Understand your dependencies (See <a href="extensions/index.html#uml-dumper">UML Dumper</a>)</li>
<li>And even restrict what types and how they should be created (See <a href="user_guide/index.html#di_constructible">Constructible Policy</a>)</li>
</ul>
<h3 id="real-life-examples">Real Life examples?</h3>
<ul>
<li><a href="https://github.com/modern-cpp-examples/match3">Match-3 Game</a><ul>
<li>Simple web game in C++14 using SDL2 / Model View Controller / Meta State Machine / Dependency Injection / Range-V3 / Emscripten</li>
<li><a href="http://modern-cpp-examples.github.io/match3">Play it online!</a></li>
</ul>
</li>
</ul>
<blockquote></blockquote>
<ul>
<li><a href="https://github.com/krzysztof-jusiak/mocks_injector">Automatic Mocks Injector</a><ul>
<li>Automatically create and inject required mocks to tested classes via constructors</li>
</ul>
</li>
</ul>
<blockquote></blockquote>
<ul>
<li><a href="http://boost-experimental.github.io/msm-lite/">Experimental Boost.MSM-lite</a><ul>
<li>C++14 header only eUML-like Meta State Machine library with no dependencies</li>
</ul>
</li>
</ul>
<h3 id="why-boostdi">Why Boost.DI?</h3>
<ul>
<li>Boost.DI has none or minimal run-time overhead (See <a href="overview/index.html#performance">Performance</a>)</li>
<li>Boost.DI compiles fast / <strong>Faster than Java-<a href="https://github.com/google/dagger">Dagger2</a>!</strong> (See <a href="overview/index.html#benchmarks">Benchmarks</a>)</li>
<li>Boost.DI gives short diagnostic messages (See <a href="overview/index.html#error-messages">Error messages</a>)</li>
<li>Boost.DI is non-intrusive (See <a href="user_guide/index.html#injections">Injections</a>)</li>
<li>Boost.DI reduces boilerplate code (See <a href="tutorial/index.html#1-basic-create-objects-tree">Create Objects Tree</a>)</li>
<li>Boost.DI reduces testing effort (See <a href="extensions/index.html#mocks-provider">Mocks Provider</a>)</li>
<li>Boost.DI gives better control of what and how is created (See <a href="user_guide/index.html#di_constructible">Constructible Policy</a>)</li>
<li>Boost.DI gives better understanding about objects hierarchy (See <a href="extensions/index.html#uml-dumper">UML Dumper</a>)</li>
</ul>
<pre><code class="cpp">+---------------------------------------------------+
|$CXX -std=c++14 -fno-exceptions -O2 hello_world.cpp|
|#Compiles in 0.4s!                                 |
+-----------------------------+---------------------+
                              |
                              \
                                  #include &lt;boost/di.hpp&gt; +-----------+
 +-----------------------------+                                      |
 |                             |  namespace di = boost::di;     +-----+--------------------------------+
 |                             +-+                              |One header (3k lines, no dependencies)|
 |  +-----------------------+    +struct uniform {              +--------------------------------------+
 |  |Automatic conversion   |       bool &amp;b;
 |  |between std::shared_ptr+------+boost::shared_ptr&lt;interface&gt; sp;
 |  |and boost::shared_ptr  |     };
 |  +-----------------------+
 |                             +-+class direct {
 |                          +--+   public:                                 +---------------------------+
 |                          |       direct(const uniform &amp;uniform          |ASM x86-64 == `make_unique`|
 |               +----------+            , std::shared_ptr&lt;interface&gt; sp)  +---------------------------+
 |               |                    : uniform_(uniform)                  |push   %rax                |
 |               |                  , sp_(sp)                              |mov    $0x8,%edi           |
 |               |                  {}                                     |callq  0x4007b0 &lt;_Znwm@plt&gt;|
 |               |                                                         |movq   $0x400a10,(%rax)    |
 | +-------------+----------+       const uniform &amp;uniform_;               |mov    $0x8,%esi           |
 | |Inject  dependencies    |       std::shared_ptr&lt;interface&gt; sp_;        |mov    %rax,%rdi           |
 | |using T{...} or T(...)  |     };                                       |callq  0x400960 &lt;_ZdlPvm&gt;  |
 +-+without REFLECTION or   |                                +-------------+mov    $0x1,%eax           |
   |any changes/registration+-----+class hello_world {       |             |pop    %rdx                |
   |in the code!            |      public:                   +             |retq                       |
   +------------------------+       hello_world(std::unique_ptr&lt;direct&gt; d  +-------------------------+-+
                                   +--------+ , interface &amp;ref                                       |
                                   |          , int i)+-------------------------------------------+  +-+
                                   |  : i_(i) {                                                   |    |
                                   |  assert(false == d-&gt;uniform_.b);                             |    |
                     +-------------+  assert(d-&gt;sp_.get() == d-&gt;uniform_.sp.get());               |    |
                     |                assert(&amp;ref == d-&gt;sp_.get());     +                         |    |
    +----------------+---------+    }                         +         |                         |    |
    |Deduce scope based on     |                              |         |                         |    |
    |constructor parameter type|    auto run() const {        +---------+ +--------------------+  |    |
    |T -&gt; unique               |      return i_ == 42;                  +-+The same shared_ptr,|  |    |
    |T&amp; -&gt; singleton           |    }                                     |reference provided  |  |    |
    |shared_ptr -&gt; singleton   |                                          +--------------------+  |    |
    |unique_ptr |&gt; unique      |   private:                                                       |    |
    +--------------------------+    int i_ = 0;                                                +--+    |
                                  };                                                           |       |
                                                                                               |       |
                                  int main() {                          +----------------------+--+    |
                                    auto runtime_value = false;         |ASM x86-64 == 'return 42'|    |
                                                                        +-------------------------+    |
                    +-------------+ auto module = [&amp;] {                 |mov $0x2a,%eax           |    |
            +-------+-----------+     return di::make_injector(         |retq                     |    |
            |Split configuration|       di::bind&lt;&gt;().to(runtime_value)  +----+--------------------+    |
            |into modules       |     );                                     |                         |
            +-------+-----------+   };                                       |                         |
                    |         +----------------------------------------------+                         |
                    |         |     auto injector = di::make_injector(                                 |
                    |         |       di::bind&lt;interface&gt;().to&lt;implementation&gt;()+----------------------+
                    |         +---+ , di::bind&lt;&gt;().to(42)
                    +--------------+, module()                                     +---------------------+
                                    );                                  +----------+Compile time creation|
                                                                        +          |guarantee!           |
                                    auto object = injector.create&lt;hello_world&gt;();  +---------------------+
                                    assert(object.run());  +
                                  }                        |
                                                           |  +----------------------------------------+
                                                           +--+Short compile time error messages!      |
                                                              |For example:                            |
                                                              |`abstract_type&lt;interface&gt;::is_not_bound`|
                                                              +----------------------------------------+
</code></pre>

<ul>
<li>
<p><a href="https://raw.githubusercontent.com/boost-experimental/di/cpp14/example/hello_world.cpp">https://raw.githubusercontent.com/boost-experimental/di/cpp14/example/hello_world.cpp</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/boost-experimental/di/cpp14/extension/policies/uml_dumper.cpp"> UML Dumper Extension</a></p>
</li>
<li><a href="https://raw.githubusercontent.com/boost-experimental/di/cpp14/extension/injections/xml_injection.cpp"> XML Injection Extension</a></li>
<li><a href="https://raw.githubusercontent.com/boost-experimental/di/cpp14/example/user_guide/policies_constructible_local.cpp"> Constructible Example</a></li>
</ul>
<p><br /><br /></p>
<h3 id="boostdi-design-goals">Boost.DI design goals</h3>
<ul>
<li>Be as fast as possible (See <a href="overview/index.html#performance">Performance</a>)</li>
<li>Compile as fast as possible (See <a href="overview/index.html#benchmarks">Benchmarks</a>)</li>
<li>Give short and intuitive error messages (See <a href="overview/index.html#error-messages">Error messages</a>)</li>
<li>Guarantee object creation at compile-time (See <a href="tutorial/index.html#1-basic-create-objects-tree">Create Objects Tree</a>)</li>
<li>Be as non-intrusive as possible (See <a href="user_guide/index.html#injections">Injections</a>)</li>
<li>Be easy to extend (See <a href="extensions/index.html">Extensions</a>)</li>
</ul>
<h3 id="acknowledgements">Acknowledgements</h3>
<ul>
<li>Thanks to Bartosz Kalinczuk for code review and tips how to improve <code>Boost.DI</code></li>
<li>Thanks to Sohail Somani for support and tips how to improve <code>Boost.DI</code></li>
<li>Thanks to Rob Stewart and Robert Ramey for documentation feedback and tips how to improve it</li>
</ul>
</div>

<script src="./js/highlight.pack.js"></script>

<script>
hljs.configure({languages:['cpp']});
hljs.initHighlightingOnLoad();
</script>

<div class="copyright-footer">Copyright &copy; 2016
      <p>Distributed under the Boost Software License, Version 1.0.
      (See accompanying file <code class="filename">LICENSE_1_0.txt</code> or copy at
      <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div>

</div>

<hr>
<div class="spirit-nav">
<a accesskey="p"  ><img src="./images/prev.png" alt="Prev"></a><a accesskey="u" href="index.html"><img src="./images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="./images/home.png" alt="Home"></a><a accesskey="n"  href="overview/index.html"><img src="./images/next.png" alt="Next"></a>
</div>

<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<select onChange="window.location.href=this.value" style="position: absolute; top: 20px; right: 30px; z-index: 10;">
    <option value="https://boost-experimental.github.io/di">Theme: Boost Experimental</option>
    <option value="https://boost-experimental.github.io/di/boost" selected>Theme: Boost Classic</option>
</select>
</body>
</html>